{% extends 'home/index.html' %}

{% load static crispy_forms_filters %}

{% block extra-style %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'sweetalert2/dist/sweetalert2.min.css' %}">
    <link rel="stylesheet" href="{% static 'seguros/css/form.min.css' %}">
{% endblock %}

{% block header-slider %}{% endblock %}

{% block sub-header %}{% endblock %}

{% block content %}
    <div class="content">
        {% include form_content %}
    </div>
{% endblock %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static 'jquery/dist/jquery.min.js' %}"></script>
    <script src="{% static 'sweetalert2/dist/sweetalert2.all.min.js' %}"></script>

    <script type="text/javascript">
      $(document).ready(function () {
        $(document).on('submit', 'form', function (event) {
          event.preventDefault();
          const data = new FormData(this);
          $.ajax('.', {
            method: "POST",
            data: data,
            contentType: false,
            processData: false,
            success: function (response) {
              if (response.result === 'success') {
                swal({
                  title: '',
                  text: 'Su solicitud de cotización está en proceso.',
                  type: 'success',
                }).then(() => window.location.href = "{% url 'home:index' %}")
              } else {
                $('.content').html(response.form)
              }
              console.log(response)
            },
          })
        })
      });
    </script>
{% endblock %}
